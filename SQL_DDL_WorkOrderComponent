-- Table: ContractorOrganisation
CREATE TABLE ContractorOrganisation (
    ContractorOrganisationID VARCHAR(255) PRIMARY KEY, -- Unique ID for the contractor organisation
    Name VARCHAR(255),                                -- Name of the contractor
    ContractorPortal VARCHAR(255),                    -- Portal used by the contractor
    Subcontractors TEXT                               -- List of subcontractors used
);

-- Table: WorkClass
CREATE TABLE WorkClass (
    WorkClassID VARCHAR(255) PRIMARY KEY,             -- Unique ID for the work class
    WorkClassCode VARCHAR(100),                       -- Short code for work class
    WorkClassDescription TEXT                         -- Detailed description of the work class
);

-- Table: WorkPriority
CREATE TABLE WorkPriority (
    WorkPriorityID VARCHAR(255) PRIMARY KEY,          -- Unique ID for work priority
    PriorityCode VARCHAR(100),                        -- Code representing the priority
    PriorityDescription TEXT,                         -- Description of the priority
    EffectiveDateTime TIMESTAMP,                      -- When this priority became effective
    NumberOfDays INTEGER,                             -- Number of days to resolve
    Comments TEXT,                                    -- Additional comments
    RequiredStartDateTime DATE,                       -- Required start date
    RequiredCompletionDateTime DATE                   -- Required completion date
);

-- Table: TradeCode
CREATE TABLE TradeCode (
    Code VARCHAR(100) PRIMARY KEY,                    -- Standard trade code
    CustomCode VARCHAR(100),                          -- Custom code used by provider
    CustomName VARCHAR(255)                           -- Custom name for the trade
);

-- Table: RateScheduleItem
CREATE TABLE RateScheduleItem (
    RateScheduleItemID VARCHAR(255) PRIMARY KEY,      -- Unique ID for the rate schedule item
    M3NHFSORCode VARCHAR(100),                        -- M3 NHF Schedule of Rates code
    Quantity DECIMAL(10, 2),                          -- Quantity required
    CustomCode VARCHAR(100),                          -- Custom rate code
    CustomName VARCHAR(255)                           -- Custom name for rate item
);

-- Table: WorkElement
CREATE TABLE WorkElement (
    WorkElementID VARCHAR(255) PRIMARY KEY,           -- Unique ID for the work element
    WorkOrderID VARCHAR(255),                         -- FK to the associated work order
    RateScheduleItemID VARCHAR(255),                  -- FK to RateScheduleItem
    TradeCode VARCHAR(100),                           -- FK to TradeCode
    ServiceChargeSubject VARCHAR(255),                -- Subject to service charge?
    CONSTRAINT FK_WorkElement_WorkOrder FOREIGN KEY (WorkOrderID) REFERENCES WorkOrder(WorkOrderID),
    CONSTRAINT FK_WorkElement_RateScheduleItem FOREIGN KEY (RateScheduleItemID) REFERENCES RateScheduleItem(RateScheduleItemID),
    CONSTRAINT FK_WorkElement_TradeCode FOREIGN KEY (TradeCode) REFERENCES TradeCode(Code)
);

-- Table: WorkElementDependency
CREATE TABLE WorkElementDependency (
    WorkElementID VARCHAR(255),                       -- FK to dependent work element
    DependsOnWorkElementID VARCHAR(255),              -- FK to the required previous element
    Type VARCHAR(100),                                -- Type of dependency
    Timing VARCHAR(255),                              -- Timing constraint or information
    CONSTRAINT PK_WorkElementDependency PRIMARY KEY (WorkElementID, DependsOnWorkElementID),
    CONSTRAINT FK_WorkElementDependency_WorkElement FOREIGN KEY (WorkElementID) REFERENCES WorkElement(WorkElementID),
    CONSTRAINT FK_WorkElementDependency_DependsOn FOREIGN KEY (DependsOnWorkElementID) REFERENCES WorkElement(WorkElementID)
);

-- Table: WorkOrder
CREATE TABLE WorkOrder (
    WorkOrderID VARCHAR(255) PRIMARY KEY,             -- Unique ID for the work order
    WorkElementID VARCHAR(255),                       -- Possibly a representative element (optional FK)
    AddressID VARCHAR(255),                           -- FK to address
    InspectionID VARCHAR(255),                        -- FK to inspection
    EscalationID VARCHAR(255),                        -- FK to escalation event
    TenancyID VARCHAR(255),                           -- FK to tenancy
    TenantID VARCHAR(255),                            -- FK to tenant
    HazardReportID VARCHAR(255),                      -- FK to hazard report
    WorkClassID VARCHAR(255),                         -- FK to WorkClass
    LocationAlerdID VARCHAR(255),                     -- FK to location alert
    PersonAlertID VARCHAR(255),                       -- FK to person alert
    WorkPriorityID VARCHAR(255),                      -- FK to WorkPriority
    ContractorOrganisationID VARCHAR(255),            -- FK to ContractorOrganisation
    DateRaised DATE,                                  -- When the work order was raised
    DateReported DATE,                                -- When it was reported
    PlannedStartDate DATE,                            -- Planned start date
    PlannedFinishDate DATE,                           -- Planned finish date
    ActualStartDateTime TIMESTAMP,                    -- Actual start timestamp
    ActualCompletionDateTime TIMESTAMP,               -- Actual completion timestamp
    DescriptionOfWork TEXT,                           -- Detailed work description
    EstimatedCost DECIMAL(10, 2),                     -- Estimated cost of work
    EstimatedLabourHours DECIMAL(5, 2),               -- Estimated labour hours
    LocationOfRepair VARCHAR(255),                    -- Where the repair is happening
    JobStatusUpdate VARCHAR(255),                     -- Last known job status
    RepairSLABreachFlag VARCHAR(10),                  -- SLA breach indicator (Y/N/Null)
    CONSTRAINT FK_WorkOrder_WorkClass FOREIGN KEY (WorkClassID) REFERENCES WorkClass(WorkClassID),
    CONSTRAINT FK_WorkOrder_WorkPriority FOREIGN KEY (WorkPriorityID) REFERENCES WorkPriority(WorkPriorityID),
    CONSTRAINT FK_WorkOrder_ContractorOrg FOREIGN KEY (ContractorOrganisationID) REFERENCES ContractorOrganisation(ContractorOrganisationID)
);

-- Table: WorkOrderStatusHistory
CREATE TABLE WorkOrderStatusHistory (
    WorkOrderStatusHistoryID VARCHAR(255) PRIMARY KEY, -- Unique ID for each status update
    WorkOrderID VARCHAR(255),                          -- FK to the related work order
    StatusCode VARCHAR(100),                           -- Code of the current status
    UpdatedBy VARCHAR(255),                            -- Who updated it
    Reason TEXT,                                       -- Reason for this status
    ReasonCode VARCHAR(100),                           -- Code representing reason
    CreatedDateTime TIMESTAMP,                         -- When status was created
    EnteredDateTime TIMESTAMP,                         -- When status was entered
    ExistedDateTime TIMESTAMP,                         -- When status ended
    Comments TEXT,                                     -- Any extra comments
    CONSTRAINT FK_WorkOrderStatusHistory_WorkOrder FOREIGN KEY (WorkOrderID) REFERENCES WorkOrder(WorkOrderID)
);

-- Table: WorkOrderComplete
CREATE TABLE WorkOrderComplete (
    WorkOrderCompleteID VARCHAR(255) PRIMARY KEY,      -- Unique ID for completion record
    WorkOrderID VARCHAR(255),                          -- FK to completed work order
    BillOfMeterialItem VARCHAR(255),                   -- Bill of materials
    CompletedWorkElements TEXT,                        -- Description of completed elements
    OperativesUsed TEXT,                               -- Who completed the work
    JosStatusUpdate VARCHAR(255),                      -- Status update
    FollowOnWork VARCHAR(255),                         -- Follow-on work needed
    CONSTRAINT FK_WorkOrderComplete_WorkOrder FOREIGN KEY (WorkOrderID) REFERENCES WorkOrder(WorkOrderID)
);

-- Table: WorkOrderAccessInformation
CREATE TABLE WorkOrderAccessInformation (
    AccessInformationID VARCHAR(255) PRIMARY KEY,      -- Unique ID for access record
    WorkOrderID VARCHAR(255),                          -- FK to work order
    AccessType VARCHAR(100),                           -- Type of access (e.g. key, presence)
    AccessDetails TEXT,                                -- Detailed access info
    AccessDateTime TIMESTAMP,                          -- When access was made
    CONSTRAINT FK_WorkOrderAccess_WorkOrder FOREIGN KEY (WorkOrderID) REFERENCES WorkOrder(WorkOrderID)
);

-- Table: AlertRegardingLocation
CREATE TABLE AlertRegardingLocation (
    AlertID VARCHAR(255) PRIMARY KEY,                  -- Unique alert ID
    WorkOrderID VARCHAR(255),                          -- FK to work order
    AlertType VARCHAR(100),                            -- Type of location alert
    Description TEXT,                                  -- Description of the alert
    AlertDate TIMESTAMP,                               -- When alert was raised
    CONSTRAINT FK_AlertLocation_WorkOrder FOREIGN KEY (WorkOrderID) REFERENCES WorkOrder(WorkOrderID)
);

-- Table: AlertRegardingPerson
CREATE TABLE AlertRegardingPerson (
    AlertID VARCHAR(255) PRIMARY KEY,                  -- Unique alert ID
    WorkOrderID VARCHAR(255),                          -- FK to work order
    PersonID VARCHAR(255),                             -- FK to person being alerted on
    AlertType VARCHAR(100),                            -- Type of person alert
    Description TEXT,                                  -- Description of the alert
    AlertDate TIMESTAMP,                               -- When alert was raised
    CONSTRAINT FK_AlertPerson_WorkOrder FOREIGN KEY (WorkOrderID) REFERENCES WorkOrder(WorkOrderID)
);