// Work Order Module DBML Schema

Table WorkPriority {
    ID varchar [pk]
    PriorityCode varchar
    PriorityDescription varchar
    EffectiveDateTime int
    NumberOfDays int
    Comments text
    RequiredStartDateTime timestamp
    RequiredCompletionDateTime timestamp
}

Table WorkElement {
    WorkElementID varchar [pk]
    RateScheduleItem varchar
    ImpactedAssetReference varchar
    Trade int
    ServiceChargeSubject varchar
    DependsOn varchar
}

Table WorkElementDependency {
    WorkElementID varchar
    DependsOnWorkElement varchar
    Type varchar
    Timing interval
    
    indexes {
        (WorkElementID, DependsOnWorkElement) [pk]
    }
}

Table WorkOrder {
    WorkOrderID int [pk]
    WorkElementID varchar
    AddressID int
    InspectionID int
    EscalationID int
    TenancyID int
    TenantID int
    LocationAlertID varchar
    PersonAlertID varchar
    WorkPriorityID varchar
    HazardReportID varchar
    DateRaised date
    DateReported date
    PlannedStartDate date
    PlannedFinishDate date
    ActualCompletionDateTime timestamp
    DescriptionOfWork text
    EstimatedCost decimal
    EstimatedLabourHours int
    LocationOfRepair text
    JobStatusUpdate text
    SpatialLocation text
    RepairSLABreachFlag text
}

Table WorkOrderStatusHistory {
    WorkOrderID int
    Status text
    UpdatedBy text
    Timestamp timestamp
    Comments text

    indexes {
        (WorkOrderID, Timestamp) [pk]
    }
}

Table WorkOrderComplete {
    WorkOrderID varchar [pk]
    BillOfMaterialItem text
    CompletedWorkElements text
    OperativesUsed text
    JobStatusUpdate text
    FollowOnWork text
}

Table WorkOrderAccessInformation {
    WorkOrderID varchar [pk]
    KeySafe text
    Description text
}

Table AlertRegardingLocation {
    ID varchar [pk]
    Type text
    Attachment text
    Comments text
}

Table AlertRegardingPerson {
    ID varchar [pk]
    Type text
    Comments text
}

Table WorkClass {
    ID varchar [pk]
    WorkClassCode varchar
    WorkClassDescription varchar
}

Table ContractorOrganisation {
    ID varchar [pk]
    Name text
    ContractorPortal text
    Subcontractors text
}

Table TradeCode {
    Code varchar [pk]
    CustomCode varchar
    CustomName varchar
}

Table RateScheduleItem {
    ID varchar [pk]
    M3NHFSORCode varchar
    CustomCode varchar
    CustomName varchar
}

// Relationships
Ref: WorkOrder.WorkElementID > WorkElement.WorkElementID
Ref: WorkElementDependency.WorkElementID > WorkElement.WorkElementID
Ref: WorkElementDependency.DependsOnWorkElement > WorkElement.WorkElementID
Ref: WorkOrderStatusHistory.WorkOrderID > WorkOrder.WorkOrderID
Ref: WorkOrderComplete.WorkOrderID > WorkOrder.WorkOrderID
Ref: WorkOrderAccessInformation.WorkOrderID > WorkOrder.WorkOrderID

